<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.jav.server.dao.relation.MovieStudioDao">
    <!-- MovieStudioRelation resultMap -->
    <resultMap id="movieStudioRelationResultMap"
        type="com.jav.server.entity.relation.MovieStudioRelation">
        <id property="id" column="id" />
        <result property="movieId" column="movie_id" />
        <result property="studioId" column="studio_id" />
    </resultMap>
    <!-- 添加电影与工作室关系 -->
    <insert id="addMovieStudioRelation"
        parameterType="com.jav.server.entity.relation.MovieStudioRelation"> INSERT
        INTO movie_studio_relation (movie_id, studio_id) VALUES (#{movieId}, #{studioId}) </insert>

    <!-- 删除电影与工作室关系 -->
    <delete id="deleteMovieStudioRelation"> DELETE FROM movie_studio_relation WHERE movie_id =
        #{movieId} AND studio_id = #{studioId} </delete>

    <select id="queryMovieStudioRelation"
        resultMap="movieStudioRelationResultMap"> SELECT * FROM
        movie_studio_relation WHERE movie_id = #{movieId} AND studio_id = #{studioId} </select>

    <!-- queryMovieStudioRelationByMovieId --> 

    <select id="queryMovieStudioRelationByMovieId" resultMap="movieStudioRelationResultMap">
        SELECT * 
        FROM movie_studio_relation 
        WHERE movie_id = #{movieId}
    </select>

    <!-- 更新电影与工作室关系 -->
    <update id="updateMovieStudioRelations" parameterType="java.util.List">
        <foreach collection="relations" item="relation" separator=";">
            UPDATE movie_studio_relation
            SET movie_id = #{relation.movieId}, studio_id = #{relation.studioId}
            WHERE id = #{relation.id}
        </foreach>
    </update>
</mapper>
